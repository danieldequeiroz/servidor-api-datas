<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Servidor API DATAS Paraíba</title>

    <style>
        /* Estilo para telas grandes (desktop) */
        @media (min-width: 1025px) {
          
            :root {
                --rdp-accent-color: #BEF264;
                --rdp-accent-background-color: #0b0b0b;
                --rdp-font-family: system-ui, sans-serif;
                --btn-border-radius: 12px;
                --btn-padding: 12px 24px;
                --btn-bg-color: #BEF264;
                --btn-text-color: #0a0a0a;
                --btn-bg-hover: #BEF201;
                --btn-text-hover: #0b0b0b;
                --btn-font-size: 1rem;
                --btn-transition: 0.3s ease;
                
          
            }

            body {
              font-family: Arial, sans-serif;
                background-color: black;
                color: white;
                padding: 20px;
                text-align: center;
                font-weight: bold; 

            }

            img {
                display: block;
                margin: 20px auto;
            }

            button {
    background-color: var(--btn-bg-color);
    color: var(--btn-text-color);
    border: none;
    padding: var(--btn-padding);
    font-size: var(--btn-font-size);
    cursor: pointer;
    border-radius: var(--btn-border-radius);
    transition: background-color var(--btn-transition), color var(--btn-transition);
    margin-left: 20px; /* Espaça o botão à direita dos inputs */
    align-self: flex-start; /* Alinha o botão à direita no topo */
    
}

            button:hover {
                background-color: var(--btn-bg-hover);
                color: var(--btn-text-hover);
            }

              /* Estilo específico para o btn-calcular */
        #btn-calcular {
            margin: 0 auto; /* Centraliza o botão "Calcular" horizontalmente */
            display: block; /* Faz o botão ocupar o centro no container */
        }

            #data-inicial-container, #data-final-container, #quant-dias-uteis-container{
    display: flex; /* Alinha os elementos lado a lado */
    flex-wrap: nowrap; /* Garante que os itens não quebrem para a próxima linha */
    justify-content: flex-start; /* Alinha os elementos à esquerda */
    align-items: center; /* Alinha verticalmente os itens */
    margin: 20px 0;
        flex-direction: column;

}



label {
    margin-right: 10px; /* Espaçamento entre o label e o input */
}

input[type="date"], input[type="number"] {
    padding: 10px;
    border-radius: 8px;
    border: 2px solid #ccc;
    background-color: #fff;
    color: #000;
    margin-right: 30px; /* Adiciona espaço entre os campos */
    border-color: rgb(229, 231, 235);
}

            table {
                width: 100%;
                margin: 20px 0;
                border-collapse: collapse;
            }

            th, td {
                border: 1px solid #ddd;
                padding: 12px;
            }

            th {
                background-color: var(--rdp-accent-background-color);
                color: var(--rdp-accent-color);
            }

            td {
                background-color: #333;
            }

            #result {
                margin-top: 30px;
                padding: 10px;
                background-color: #222;
                border-radius: 8px;
                font-weight: bold; 
            }

        }

       /* Estilo para telas pequenas (celulares) */
    @media (max-width: 1024px) {
        body {
            font-family: var(--rdp-font-family);
            background-color: black;
            color: white;
            padding: 20px;
            text-align: center;
            font-size: 0.9rem; /* Reduz o tamanho da fonte em telas menores */
        }

        button, input {
        padding: 10px; /* Diminuir o padding para telas menores */
    }
            :root {
                --rdp-accent-color: green;
                --rdp-accent-background-color: #0b0b0b;
                --rdp-font-family: system-ui, sans-serif;
                --btn-border-radius: 12px;
                --btn-padding: 12px 24px;
               --btn-bg-color: #BEF264;
                --btn-text-color: #0a0a0a;
                --btn-bg-hover: #00b33c;
                --btn-text-hover: #0b0b0b;
                --btn-font-size: 1rem;
                --btn-transition: 0.3s ease; 
            }
            

        button {
            display: block;
            width: 100%;
            background-color: var(--btn-bg-color);
            color: var(--btn-text-color);
            border: none;
            padding: var(--btn-padding);
            font-size: var(--btn-font-size);
            cursor: pointer;
            border-radius: var(--btn-border-radius);
            transition: background-color var(--btn-transition), color var(--btn-transition);
            margin: 10px 0;
        }

        button:hover {
            background-color: var(--btn-bg-hover);
            color: var(--btn-text-hover);
        }

        input {
            font-family: Arial, sans-serif;
            text-size-adjust: 100%;
            box-sizing: border-box;
            border: 2px solid #ccc;
            padding: 10px;
            border-radius: 8px;
            background-color: #fff;
            color: #000;
        }

        #data-inicial-container, #data-final-container, #quant-dias-uteis-container {
    display: flex; /* Alinha os itens lado a lado */
    justify-content: center; /* Centraliza os itens horizontalmente */
    align-items: center; /* Alinha os itens verticalmente no centro */
   
    text-align: center; /* Centraliza o texto */
    flex-direction: column; /* Colocar os elementos em coluna */
    margin: 10px 0; /* Ajustar margens para telas menores */
}

#data-inicial-container input,
#data-final-container input,
#quant-dias-uteis-container input {
  margin: 5px 0; /* Diminuir o espaço entre os inputs */
  width: 90%; /* Reduzir a largura para caber na tela */}



.form-container {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 20px; /* Espaçamento entre os contêineres */
}

#labelCategoriaFeriado span {
    white-space: normal; /* Permite a quebra de linha automática */
    word-wrap: break-word; /* Quebra as palavras, se necessário */
}


        #result {
            margin-top: 30px;
            padding: 10px;
            background-color: #222;
            border-radius: 8px;
            font-weight: bold;
            font-size: 0.9rem;
        }
       
  
}

    
</style>
</head>


<body>
  
  <img src="logopretadejp.jpg" alt="Logo do Servidor API DATAS" width="150" height="80" />
  <br> </br>
    <!-- Botões para selecionar a ação desejada -->
    <button id="btn-data">Intervalo de Datas</button> <!-- Botão para calcular dias úteis entre duas datas -->
    <button id="btn-dias-uteis">Data Final</button> <!-- Botão para calcular a data final após adicionar dias úteis -->
    <button id="btn-feriados">Todos os Feriados</button> <!-- Botão para exibir feriados -->
    <button id="btn-feriadosfixos">Feriados Fixos</button> <!-- Botão para ve feriados fixos -->
    <button id="btn-feriadosnaofixos">Feriados Não Fixos</button> <!-- Botão para ve feriados nao fixos -->
    <button id="btn-addferiados">Adicionar Feriados</button> <!-- Botão para adicionar feriados -->

    <script>
      const btnFeriadosFixos = document.getElementById('btn-feriadosfixos');

btnFeriadosFixos.addEventListener('click', () => {
  fetch('/api/feriadosfixos')
    .then(response => response.json())
    .then(data => console.log(data))
    .catch(error => console.error(error));
});
    </script>

    <br>

    <!-- Contêineres de entrada de dados -->
    <div id="data-inicial-container" style="display: none;"> <!-- Contêiner para selecionar a data inicial, oculto por padrão -->
        <label for="data-inicial">Data Inicial:</label>
        <input type="date" id="data-inicial" name="dataInicial"> <!-- Campo de entrada para a data inicial -->
    </div>

    <div id="data-final-container" style="display: none;"> <!-- Contêiner para selecionar a data final, oculto por padrão -->
        <label for="data-final">Data Final:</label>
        <input type="date" id="data-final" name="dataFinal"> <!-- Campo de entrada para a data final -->
    </div>

    <div id="quant-dias-uteis-container" style="display: none;"> <!-- Contêiner para inserir a quantidade de dias úteis, oculto por padrão -->
        <label for="quant-dias-uteis">Quantidade de Dias Úteis:</label>
        <input type="number" id="quant-dias-uteis" name="quantDiasUteis"> <!-- Campo de entrada para a quantidade de dias úteis -->
    </div>

    <button id="btn-calcular" style="display: none;">Calcular</button> <!-- Botão para iniciar o cálculo, oculto por padrão -->
    <div id="map"></div>
    <div id="feriados-fixos-container" ></div>
    <div id="feriadosnaofixos-container" ></div>
    <div id="feriadosnaofixos-container" style="display: none;"></div>

    <!-- Div para exibir os resultados -->
    <div id="result">
        <label id="result-label"></label> <!-- Rótulo para o resultado (ex: "Dias Úteis:") -->
        <div id="result-content"></div> <!-- Div para exibir o conteúdo do resultado -->
    </div>

    <script>
      document.getElementById("btn-feriadosfixos").addEventListener("click", function() {
      fetch('/api/feriadosfixos')
        .then(response => response.json())
        .then(data => console.log(data))
        .catch(error => console.error(error));
    });
    </script>

    <script>
        // Referências aos elementos da página
        const btnData = document.getElementById('btn-data');
        const btnDiasUteis = document.getElementById('btn-dias-uteis');
        const btnFeriados = document.getElementById('btn-feriados');
        const btnCalcular = document.getElementById('btn-calcular');
        const resultLabel = document.getElementById('result-label');
        const resultContent = document.getElementById('result-content');

        // Função para esconder todos os contêineres de entrada e limpar os resultados
        function hideAllContainers() {
            document.getElementById('data-inicial-container').style.display = 'none';
            document.getElementById('data-final-container').style.display = 'none';
            document.getElementById('quant-dias-uteis-container').style.display = 'none';
       document.getElementById('feriados-fixos-container').style.display = 'none';
           document.getElementById('feriadosnaofixos-container').style.display = 'none';
            btnCalcular.style.display = 'none';
            resultLabel.innerHTML = '';
            resultContent.innerHTML = '';
            
         // Remove the form created by the "Adicionar Feriados" button
         
  if (formNovoFeriado) {
    formNovoFeriado.remove();
  }
};

        // Evento para o botão "Data Inicial, Data Final. Retorno: dias úteis."
        btnData.addEventListener('click', () => {
            hideAllContainers(); // Esconde todos os contêineres
            document.getElementById('data-inicial-container').style.display = 'block'; // Exibe o contêiner da data inicial
            document.getElementById('data-final-container').style.display = 'block'; // Exibe o contêiner da data final
            btnCalcular.style.display = 'block'; // Exibe o botão de calcular
            btnCalcular.removeEventListener('click', calculateData); // Remove evento anterior para evitar múltiplas chamadas
            btnCalcular.removeEventListener('click', calculateDiasUteis);
            btnCalcular.addEventListener('click', calculateData); // Adiciona o evento para calcular dias úteis entre as datas
         // Remove the form created by the "Adicionar Feriados" button
  if (formNovoFeriado) {
    formNovoFeriado.remove();
  }
  
});

        // Evento para o botão "Data Inicial, quant dias úteis. Retorno: data final."
        btnDiasUteis.addEventListener('click', () => {
            hideAllContainers(); // Esconde todos os contêineres
            document.getElementById('data-inicial-container').style.display = 'block'; // Exibe o contêiner da data inicial
            document.getElementById('quant-dias-uteis-container').style.display = 'block'; // Exibe o contêiner da quantidade de dias úteis
            btnCalcular.style.display = 'block'; // Exibe o botão de calcular
            btnCalcular.removeEventListener('click', calculateData); // Remove evento anterior para evitar múltiplas chamadas
            btnCalcular.removeEventListener('click', calculateDiasUteis);
            btnCalcular.addEventListener('click', calculateDiasUteis); // Adiciona o evento para calcular a data final
         // Remove the form created by the "Adicionar Feriados" button
         if (formNovoFeriado) {
            formNovoFeriado.remove();
              }
            });

        // Função para calcular os dias úteis entre duas datas
        function calculateData() {
            const dataInicial = document.getElementById('data-inicial').value; // Obtém a data inicial
            const dataFinal = document.getElementById('data-final').value; // Obtém a data final
            if (dataInicial && dataFinal) { // Verifica se ambas as datas foram fornecidas
                fetch(`/dias-uteis?dataInicial=${dataInicial}&dataFinal=${dataFinal}`) // Envia a solicitação para a API
                    .then(response => response.json()) // Converte a resposta para JSON
                    .then(data => {
                        resultLabel.innerHTML = 'Dias Úteis:'; // Exibe o rótulo do resultado
                        resultContent.innerHTML = data.diasUteis; // Exibe a quantidade de dias úteis
                    })
                    .catch(error => console.error(error)); // Exibe erros no console
            }
        }

        // Função para calcular a data final após adicionar dias úteis a uma data inicial
        function calculateDiasUteis() {
            const dataInicial = document.getElementById('data-inicial').value; // Obtém a data inicial
            const quantDiasUteis = document.getElementById('quant-dias-uteis').value; // Obtém a quantidade de dias úteis
            if (dataInicial && quantDiasUteis) { // Verifica se a data inicial e a quantidade de dias úteis foram fornecidas
                fetch(`/dias-uteis?dataInicial=${dataInicial}&quantDiasUteis=${quantDiasUteis}`) // Envia a solicitação para a API
                    .then(response => response.json()) // Converte a resposta para JSON
                    .then(data => {
                        const dataFinal = data.dataFinal; // Obtém a data final da resposta do servidor
                        const formattedDataFinal = new Date(dataFinal).toLocaleDateString('pt-BR', {
                            year: 'numeric',
                            month: '2-digit',
                            day: '2-digit'
                        }).replace('-', '-'); // Formata a data final para o formato brasileiro
                        resultLabel.innerHTML = `Data Final: ${formattedDataFinal}`; // Exibe a data final formatada
                    })
                    .catch(error => console.error(error)); // Exibe erros no console
            }
        }

        // Evento para o botão "Nenhum parâmetro. Retorno: json dos feriados..."
        btnFeriados.addEventListener('click', () => {
            hideAllContainers(); // Esconde todos os contêineres

            // Define a lista de feriados
            const data = [
                { data: '01 de Janeiro de 2024', nome: 'Dia da Confraternização Universal (Ano Novo)' },
                { data: '12, 13 e 14 de Fevereiro de 2024', nome: 'Carnaval' },
                { data: '15 de Abril de 2024', nome: 'Paixão de Cristo' },
                { data: '21 de Abril de 2024', nome: 'Tiradentes' },
                { data: '01 de Maio de 2024', nome: 'Dia do Trabalho' },
                { data: '30 de Maio de 2024', nome: 'Corpus Christi' },
                { data: '24 de Junho de 2024', nome: 'Dia de São João' },
                { data: '05 de Agosto de 2024', nome: 'Aniversário da Cidade; Dia da Padroeira das N.S. das Neves e Data magna do estado da Paraíba' },
                { data: '07 de Setembro de 2024', nome: 'Dia da Independência' },
                { data: '12 de Outubro de 2024', nome: 'Dia de Nossa Senhora Aparecida' },
                { data: '28 de Outubro de 2024', nome: 'Dia do Servidor Público' },
                { data: '02 de Novembro de 2024', nome: 'Dia de Finados' },
                { data: '15 de Novembro de 2024', nome: 'Dia da Proclamação da República' },
                { data: '20 de Novembro de 2024', nome: 'Dia da Consciência Negra' },
                { data: '08 de Dezembro de 2024', nome: 'Dia de Nossa Senhora da Conceição' },
                { data: '25 de Dezembro de 2024', nome: 'Natal' }
            ];

            // Cria uma tabela para exibir os feriados
            const table = document.createElement('table');
            table.border = '1'; // Define a borda da tabela

            const thead = document.createElement('thead'); // Cria o cabeçalho da tabela
            const tbody = document.createElement('tbody'); // Cria o corpo da tabela

            table.appendChild(thead); // Adiciona o cabeçalho à tabela
            table.appendChild(tbody); // Adiciona o corpo à tabela

            const row = document.createElement('tr'); // Cria uma linha para o cabeçalho
            const th1 = document.createElement('th');
            th1.innerHTML = 'Data'; // Cabeçalho da coluna de datas
            const th2 = document.createElement('th');
            th2.innerHTML = 'Nome do Feriado'; // Cabeçalho da coluna de nomes dos feriados

            row.appendChild(th1); // Adiciona a célula "Data" à linha do cabeçalho
            row.appendChild(th2); // Adiciona a célula "Nome do Feriado" à linha do cabeçalho
            thead.appendChild(row); // Adiciona a linha do cabeçalho ao cabeçalho da tabela

            // Adiciona cada feriado como uma linha na tabela
            data.forEach(feriado => {
                const row = document.createElement('tr');
                const td1 = document.createElement('td');
                td1.innerHTML = feriado.data; // Adiciona a data do feriado
                const td2 = document.createElement('td');
                td2.innerHTML = feriado.nome; // Adiciona o nome do feriado

                row.appendChild(td1); // Adiciona a célula de data à linha
                row.appendChild(td2); // Adiciona a célula de nome do feriado à linha
                tbody.appendChild(row); // Adiciona a linha ao corpo da tabela
            });

            // Exibe a tabela com os feriados
            resultContent.innerHTML = ''; // Limpa o conteúdo anterior
            resultContent.style.display = 'block'; // Exibe o contêiner do resultado
            resultContent.style.height = 'auto'; // Define a altura automática
            resultContent.style.width = '100%'; // Define a largura como 100%
            resultContent.appendChild(table); // Adiciona a tabela ao contêiner de resultados

            result.style.display = 'block'; // Exibe o contêiner de resultados
            result.style.overflow = 'auto'; // Define o comportamento de rolagem se necessário
         // Remove the form created by the "Adicionar Feriados" button
  if (formNovoFeriado) {
    formNovoFeriado.remove();
  }
  
});

// Evento para o botão feriados fixos
document.getElementById('btn-feriadosfixos').addEventListener('click', () => {
   // hideAllContainers('feriados-fixos-container'); // Esconde todos os contêineres
    hideAllContainers();
  // Fetch the feriados fixos data from the server
  fetch('/api/feriadosfixos.json')
    .then(response => response.json())
    .then(data => {
      // Convert the data to a JSON string
      const jsonString = JSON.stringify(data, null, 2);

      // Display the JSON string in the container
      const container = document.getElementById('feriadosnaofixos-container');
      container.innerHTML = `<pre>${jsonString}</pre>`;
      container.style.display = 'block'; // Exibe o contêiner

    })
    .catch(error => console.error(error));
    
});



// Evento para o botão feriados nao fixos
document.getElementById('btn-feriadosnaofixos').addEventListener('click', () => {
   // hideAllContainers('feriados-fixos-container'); // Esconde todos os contêineres
    hideAllContainers();
  // Fetch the feriados fixos data from the server
  fetch('/api/feriadosnaofixos.json')
    .then(response => response.json())
    .then(data => {
      // Convert the data to a JSON string
      const jsonString = JSON.stringify(data, null, 2);

      // Display the JSON string in the container
      const container = document.getElementById('feriados-fixos-container');
      container.innerHTML = `<pre>${jsonString}</pre>`;
      container.style.display = 'block'; // Exibe o contêiner

    })
    .catch(error => console.error(error));
    
});


let formNovoFeriado = null;

document.getElementById('btn-addferiados').addEventListener('click', () => {
  hideAllContainers('form-novo-feriado');

  // Remover qualquer formulário existente
  if (formNovoFeriado) {
    formNovoFeriado.remove();
  }

  // Criar o formulário
  formNovoFeriado = document.createElement('form');
  formNovoFeriado.id = 'form-novo-feriado';

  // Contêiner de data
  const datePickerContainer = document.createElement('div');
  const perguntaLabel = document.createElement('label');
  perguntaLabel.setAttribute('for', 'date');
  perguntaLabel.textContent = 'Adicione a data do feriado: ';
  
  const datePickerInput = document.createElement('input');
  datePickerInput.type = 'date';
  datePickerInput.id = 'date';
  
  datePickerContainer.appendChild(perguntaLabel);
  datePickerContainer.appendChild(datePickerInput);
  formNovoFeriado.appendChild(datePickerContainer);
formNovoFeriado.appendChild(document.createElement('br')); // Add line break


  // Nome do feriado
  const labelNome = document.createElement('label');
  labelNome.textContent = 'Nome do Feriado:';
  formNovoFeriado.appendChild(labelNome);
  

  const inputNome = document.createElement('input');
  inputNome.type = 'text';
  inputNome.id = 'nome';
  formNovoFeriado.appendChild(inputNome);
  formNovoFeriado.appendChild(document.createElement('br')); // Add line break
  formNovoFeriado.appendChild(document.createElement('br')); // Add line break


  // Tipo de feriado (fixo ou não fixo)
const labelTipoFeriado = document.createElement('div');
labelTipoFeriado.style.display = 'flex';  // Alinha os itens horizontalmente
labelTipoFeriado.style.alignItems = 'center';  // Centraliza verticalmente
labelTipoFeriado.style.justifyContent = 'center';  // Centraliza horizontalmente
labelTipoFeriado.style.marginBottom = '10px';  // Espaçamento entre o tipo e a categoria

labelTipoFeriado.innerHTML = `
  <span style="margin-right: 20px;">Escolha o tipo de feriado:</span>
  <label style="margin-right: 10px;">Feriado Fixo:</label>
  <input type="radio" id="fixed" name="fixed" value="fixed" style="margin-right: 20px;">
  <label style="margin-right: 10px;">Feriado Não Fixo:</label>
  <input type="radio" id="non-fixed" name="fixed" value="non-fixed">
`;

formNovoFeriado.appendChild(labelTipoFeriado);
// Categoria de feriado (nacional, estadual, municipal, ponto facultativo)
const labelCategoriaFeriado = document.createElement('div');
labelCategoriaFeriado.style.display = 'flex';  // Alinha os itens horizontalmente
labelCategoriaFeriado.style.alignItems = 'center';  // Centraliza verticalmente
labelCategoriaFeriado.style.justifyContent = 'center';  // Centraliza horizontalmente
labelCategoriaFeriado.style.marginBottom = '10px';  // Espaçamento entre o tipo e a categoria

formNovoFeriado.appendChild(document.createElement('br')); // Add line break
labelCategoriaFeriado.innerHTML = `
  <span style="display: block; margin-bottom: 20px;">Selecione a categoria  do feriado: \n</span>
  <l>
    <div style="display: block; margin-bottom: 10px;">
      <input type="radio" id="feriado-nacional" name="type" value="feriado nacional">
      <label style="display: inline-block; margin-left: 5px;">Feriado Nacional</label>
    </div>
  <p>
    <div style="display: block; margin-bottom: 10px;">
      <input type="radio" id="feriado-estadual" name="type" value="feriado estadual">
      <label style="display: inline-block; margin-left: 5px;">Feriado Estadual</label>
    </div>
  </p>
    <div style="display: block; margin-bottom: 10px;">
      <input type="radio" id="feriado-municipal" name="type" value="feriado municipal">
      <label style="display: inline-block; margin-left: 5px;">Feriado Municipal</label>
    </div>
  <p>
    <div style="display: block; margin-bottom: 10px;">
      <input type="radio" id="ponto-facultativo" name="type" value="ponto facultativo">
      <label style="display: inline-block; margin-left: 5px;">Ponto Facultativo</label>
    </div>
  
`;

formNovoFeriado.appendChild(labelCategoriaFeriado);

  // Botão de adicionar
  const buttonAdicionar = document.createElement('button');
  buttonAdicionar.textContent = 'Adicionar';
  formNovoFeriado.appendChild(buttonAdicionar);

  // Adiciona o formulário ao corpo do documento HTML
  document.body.appendChild(formNovoFeriado);

  // Evento de submit do formulário
  formNovoFeriado.addEventListener('submit', (e) => {
    e.preventDefault();

    // Obter dados do formulário
    const date = document.getElementById('date').value;
    const nome = document.getElementById('nome').value;
    const fixed = document.querySelector('input[name="fixed"]:checked').value;
    const type = document.querySelector('input[name="type"]:checked').value;

    // Validação dos campos obrigatórios
    if (!date || !nome || !fixed || !type) {
      alert('Por favor, preencha todos os campos antes de adicionar o feriado.');
      return;
    }

    // Enviar dados ao servidor
    fetch('/api/novo-feriado', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ date, nome, type, fixed }),
    })
      .then(response => response.json())
      .then(data => {
        alert('Feriado adicionado com sucesso!');
        formNovoFeriado.remove();
      })
      .catch(error => console.error(error));
  });
});
 /*   // Hide all containers after the form submission
 hideAllContainers();  
  //});
//});   */
    </script>
</body>
</html>
